# Metasploit and Exploitation

This page provides a explanation on how to perform scanning and enumeration using Metasploit, and explore the process of exploitation. Additionally, we will cover tools like `searchsploit` to help you identify vulnerabilities in applications.

---

## Creating a Database in PostgreSQL for Metasploit

To effectively use Metasploit with PostgreSQL, it is important to first set up and start the PostgreSQL service.

### Starting PostgreSQL
To start the PostgreSQL service on a Linux system, use the following command:
```
sudo systemctl start postgresql
```

This command ensures that PostgreSQL is up and running, allowing Metasploit to interface with it for storing data during penetration testing.

### Launch Metasploit and Check Database Status
Once PostgreSQL is running, launch Metasploit using the following command:
```
msfconsole
```

After launching Metasploit, check the database status by running:
```
db_status
```

This command will display whether the database is connected, along with the status of the connection to PostgreSQL. A successful connection is essential for Metasploit to store data like discovered hosts and services.

### Workspaces in Metasploit
Metasploit uses **workspaces** to organize data for different penetration testing engagements. Workspaces allow you to separate findings by individual tests or targets.

- To list all available workspaces, use the command:
```
workspace
```

- To create a new workspace, use the `-a` parameter:
```
workspace -a <workspace_name>
```

- To delete an existing workspace, use the `-d` parameter:
```
workspace -d <workspace_name>
```

- To view all available options for workspace management, use:
```
workspace -h
```

### Viewing Database Commands
Metasploit provides a variety of database commands that you can use within the `msfconsole`. To view all available database commands, type:
```
help
```

This will display a list of available commands, including those related to managing the database and workspaces.

---

## Scanning and Enumeration with Metasploit

Metasploit offers several tools for scanning and enumerating hosts and services. These tools allow you to gather information about your target before proceeding to exploitation.

### Port Scanning with Metasploit

You can list the available port scanning modules in Metasploit with the following command:
```
search portscan
```

This will display all available port scanning modules, including their descriptions. Once you've chosen a scanning module, you can run it against your target.

### Using Nmap with Metasploit

Metasploit integrates seamlessly with Nmap, a popular network scanning tool. You can run Nmap scans directly from the Metasploit console using the `db_nmap` command instead of `nmap`. The difference is that the results of the `db_nmap` scan will automatically be saved to the Metasploit database.

Example:
```
db_nmap -sS -T4 -p 22,80 <target_ip>
```

This command will run a TCP SYN scan on ports 22 and 80 for the specified target IP and store the results in the database.

### Listing Hosts from Scans

After performing a scan, you can list the discovered hosts by typing:
```
hosts
```

This command will display all hosts identified during the scan. If you want to add a specific host to the `RHOSTS` variable for further exploitation, use the `-r` option.

### Listing Services from Scans

To view the services discovered during a scan, use:
```
services
```

This will display all services running on the discovered hosts. You can also filter the results by a specific service using the `-s` parameter:
```
services -s <service_name>
```

This command will return only the services matching the specified service name.

---

## Process of Exploitation

Once you have gathered information through scanning and enumeration, you can move forward with exploiting vulnerabilities.

### Searching for Exploits

To search for available exploits within Metasploit, use the `search` command:
```
search <search_term>
```

This will return a list of exploits matching the search term. For example, to search for exploits related to a specific application, use:
```
search wordpress
```

Once you've found an exploit of interest, you can gather more information about it using the `info` command:
```
info <exploit_name>
```

This will provide detailed information about the exploit, including its requirements and usage instructions.

### Launching an Exploit

To launch the exploit, use the `exploit` command:
```
exploit
```

If the exploit requires additional configuration, you can set various parameters like `RHOST`, `RPORT`, and others before executing the exploit.

### Selecting a Payload

Metasploit allows you to choose a payload after selecting an exploit. Use the `show payloads` command to view available payloads:
```
show payloads
```

Once youâ€™ve selected a payload, configure it using the `set payload` command:
```
set payload <payload_name>
```

Some payloads may require additional parameters, such as the IP address and port to listen on. You can configure these parameters using the `set` command:
```
set LHOST <your_ip> set LPORT <your_port>
```

---

## Finding Vulnerabilities with Searchsploit

**Searchsploit** is a tool available in Kali Linux that provides access to a local copy of Exploit-DB, allowing you to search for vulnerabilities in various applications.

To search for vulnerabilities related to a specific application, such as WordPress, use the following command:
```
searchsploit wordpress
```

This will display a list of known vulnerabilities in WordPress, which you can investigate and potentially exploit using Metasploit.

---

## Conclusion

This guide has provided an in-depth overview of creating and managing a PostgreSQL database for Metasploit, performing scanning and enumeration, and executing exploits in Metasploit. It also covered the use of **searchsploit** to find vulnerabilities in applications. By following these steps, you can streamline the process of penetration testing and vulnerability exploitation.

